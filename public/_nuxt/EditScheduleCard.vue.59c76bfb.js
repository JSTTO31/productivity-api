import{_ as ne}from"./DatePicker.vue.7f42da0d.js";import{d as R,r as y,v as w,x as b,A as l,B as i,J as U,C as k,y as A,z as C,S as oe,b6 as re,aD as Y,b7 as B,c as O,Q,R as W,L as o,a9 as le,V as ie,H as S,ag as ee,aw as de,G as ce,u as ue,M as me}from"./entry.76ac6703.js";import{a as L,V as Z}from"./VList.48191682.js";import{u as te}from"./schedule.318b183d.js";import{V as K}from"./VChip.0bf85795.js";import{V as D}from"./VBtn.99e77a7e.js";import{V as T}from"./VTextField.5d12511c.js";import{V as pe}from"./VMenu.afbb4cec.js";import{r as H,c as $,u as ge}from"./index.68ae986f.js";import{V as X}from"./VCol.9816b50f.js";import{V as fe}from"./VForm.29a10959.js";const he={class:"d-flex flex-column"},ve={class:"ml-3"},xe=["model-value"],_e=R({__name:"TimePicker",props:["date","errorMessages"],emits:["update:date"],setup(r,{emit:g}){const s=r,d=g,n=y();function t(){n.value.showPicker()}function m(c){const f=c.target.value.split(":"),p=f[0],u=f[1],e=new Date(s.date);e.setHours(p),e.setMinutes(u),d("update:date",e)}return(c,f)=>(w(),b("div",he,[l(L,{onClick:t,class:"rounded d-flex align-center",style:{"background-color":"rgba(125, 125, 125, .1)"}},{default:i(()=>[l(U,{class:"mb-1"},{default:i(()=>[k("mdi-clock-outline")]),_:1}),A("span",ve,C(new Date(r.date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})),1)]),_:1}),A("input",{ref_key:"clock",ref:n,type:"time",onChange:m,"model-value":new Date(r.date).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}),class:"",style:{height:"0"}},null,40,xe),A("span",{class:oe(["text-caption",r.errorMessages?"text-error":"text-transparent"])},C(r.errorMessages||"example"),3)]))}});function we(){const n=Math.floor(Math.random()*360),t=Math.floor(Math.random()*(70-30+1)+30),m=Math.floor(Math.random()*(70-30+1)+30),c=ke(n,t,m);return Ae(c[0],c[1],c[2])}function ke(r,g,s){r/=360,g/=100,s/=100;let d,n,t;const m=Math.floor(r*6),c=r*6-m,f=s*(1-g),p=s*(1-c*g),u=s*(1-(1-c)*g);switch(m%6){case 0:d=s,n=u,t=f;break;case 1:d=p,n=s,t=f;break;case 2:d=f,n=s,t=u;break;case 3:d=f,n=p,t=s;break;case 4:d=u,n=f,t=s;break;case 5:d=s,n=f,t=p;break}return[Math.round(d*255),Math.round(n*255),Math.round(t*255)]}function Ae(r,g,s){return"#"+((1<<24)+(r<<16)+(g<<8)+s).toString(16).slice(1)}const Ve=re("tag",()=>{const r=y([]),{schedules:g}=Y(te());async function s(){if(!(r.value.length>0))try{const{data:t}=await B("/tags",{});t.value&&(console.log(t.value),r.value=t.value)}catch(t){return Promise.reject(t)}}async function d(t){return await B("/tags",{method:"POST",body:{label:t,color:we()},onResponse(m){r.value.push(m.response._data.tag)}})}async function n(t){return await B("/tags/"+t,{method:"delete",onResponse(){r.value=r.value.filter(m=>m._id!=t),g.value=g.value.map(m=>({...m,tags:m.tags.filter(c=>c._id!=t)}))}})}return{tags:r,getAll:s,create:d,destroy:n}}),$e={class:"d-flex flex-wrap"},be=R({__name:"TagField",props:{tags:{}},emits:["update:tags"],setup(r,{emit:g}){const s=r,d=g,{tags:n}=Y(Ve()),t=O(()=>{var p;return((p=n.value)==null?void 0:p.filter(u=>!s.tags.some(e=>e==u._id)))||[]}),m=O(()=>{var p;return((p=n.value)==null?void 0:p.filter(u=>s.tags.some(e=>e==u._id)))||[]}),c=y(!1);function f(p){d("update:tags",s.tags.filter(u=>u!=p))}return(p,u)=>(w(),b("div",$e,[(w(!0),b(Q,null,W(o(m),e=>(w(),b("div",{key:e._id,style:{position:"relative"}},[l(K,{variant:"flat",class:"text-capitalize mb-3 rounded mr-2",color:e.color},{default:i(()=>[k(C(e.label),1)]),_:2},1032,["color"]),l(D,{variant:"plain",size:"18",class:"rounded-circle bg-white",style:{position:"absolute",top:"-5px",right:"-.5px","z-index":"200px"},onClick:V=>f(e._id)},{default:i(()=>[l(U,{size:"12"},{default:i(()=>[k("mdi-close")]),_:1})]),_:2},1032,["onClick"])]))),128)),l(pe,{modelValue:o(c),"onUpdate:modelValue":u[1]||(u[1]=e=>ee(c)?c.value=e:null),"no-click-animation":!0,"close-on-content-click":!1,persistent:""},{activator:i(({props:e})=>[l(K,le(e,{class:"text-capitalize mb-3 rounded","prepend-icon":"mdi-plus",variant:"outlined"}),{default:i(()=>[k("Tag")]),_:2},1040)]),default:i(()=>[l(ie,{class:"rounded-lg",width:"300"},{default:i(()=>[o(t).length>0?(w(),S(Z,{key:0,class:"pa-5"},{default:i(()=>[l(T,{class:"mb-2",label:"Search tags...","prepend-inner-icon":"mdi-magnify","hide-details":"","single-line":"",density:"compact",variant:"solo-filled",flat:""}),(w(!0),b(Q,null,W(o(t),e=>(w(),S(L,{onClick:V=>d("update:tags",[...p.tags,e._id]),class:"px-5 text-caption rounded-lg mb-1 font-weight-light w-100",key:e._id},{prepend:i(()=>[l(U,{color:e.color},{default:i(()=>[k("mdi-square")]),_:2},1032,["color"])]),default:i(()=>[k(" "+C(e.label),1)]),_:2},1032,["onClick"]))),128))]),_:1})):(w(),S(Z,{key:1},{default:i(()=>[l(L,{class:"text-center font-weight-regular text-caption"},{default:i(()=>[k("No tags available")]),_:1})]),_:1})),l(D,{icon:"mdi-close",flat:"",size:"x-small",style:{position:"absolute",top:"5px",right:"5px"},onClick:u[0]||(u[0]=e=>c.value=!1)})]),_:1})]),_:1},8,["modelValue"])]))}}),ye={class:"d-flex mb-1 flex-column"},Me={class:"d-flex mb-2",style:{gap:"15px"}},Se={class:"d-flex pt-2",style:{gap:"5px"}},Pe=R({__name:"EditScheduleCard",props:{schedule:{}},emits:["close"],setup(r,{emit:g}){var E,F,P,N,q,G,I,j;const s=r,d=g,n=y(new Date(s.schedule.startAt));de(n,()=>{const v=new Date(t.startAt),a=new Date(t.endAt),x=new Date(n.value);x.setHours(v.getHours()),x.setMinutes(v.getMinutes());const _=new Date(n.value);_.setHours(a.getHours()),_.setMinutes(a.getMinutes()),t.startAt=x,t.endAt=_});const t=ce({title:((E=s.schedule)==null?void 0:E.title)||"",startAt:((F=s.schedule)==null?void 0:F.startAt)||new Date,endAt:((P=s.schedule)==null?void 0:P.endAt)||new Date,location:((N=s.schedule)==null?void 0:N.location)||"",recurrence:((q=s.schedule)==null?void 0:q.recurrence)||"weekly",tags:((G=s.schedule)==null?void 0:G.tags.map(v=>v._id))||[],link:((I=s.schedule)==null?void 0:I.location)||"",reminder:((j=s.schedule)==null?void 0:j.reminder)||"1 day before"});function m(v){const a=new Date(v),x=new Date(t.endAt);return a<x}function c(v){const a=new Date(v),x=new Date(t.startAt);return a>x}function f(v){const a=new Date(t.startAt),_=new Date(t.endAt)-a,z=Math.floor(_/(1e3*60*60)),M=_/(1e3*60);return z>0||M>=15}function p(v){return v?new RegExp("^https://meet.google.com|^https://zoom.us").test(v):!0}const u={title:{required:H},startAt:{required:H,lowerThan:$.withMessage("The field must before end date!",m),mustHaveDistance:$.withMessage("The field must have atleast 15 minutes distance!",f)},endAt:{required:H,greaterThan:$.withMessage("The field must after start date!",c),mustHaveDistance:$.withMessage("The field must have atleast 15 minutes distance!",f)},location:{},link:{link:$.withMessage("The field must be from gmeet or zoom!",p)},recurrence:{},tags:{},reminder:{}},e=ge(u,t),V=y(!1),se=te();ue();async function ae(){await e.value.$validate()&&s.schedule&&(V.value=!0,se.update(s.schedule._id,t).then(()=>{V.value=!1,d("close")}))}return(v,a)=>{const x=ne,_=_e,z=be;return w(),S(fe,{onSubmit:me(ae,["prevent"])},{default:i(()=>{var M,J;return[A("div",ye,[l(T,{"prepend-inner-icon":"mdi-calendar-text",density:"compact","error-messages":((M=o(e).title.$errors[0])==null?void 0:M.$message.toString())||"",class:"mb-1",variant:"solo-filled",flat:"",modelValue:o(e).title.$model,"onUpdate:modelValue":a[0]||(a[0]=h=>o(e).title.$model=h),placeholder:"What's the agenda?"},null,8,["error-messages","modelValue"])]),l(x,{date:o(n),"onUpdate:date":a[1]||(a[1]=h=>ee(n)?n.value=h:null)},null,8,["date"]),A("div",Me,[l(X,{class:"pa-0"},{default:i(()=>[l(_,{"error-messages":o(e).startAt.$errors.length>0?o(e).startAt.$errors[0].$message:"",date:o(e).startAt.$model,"onUpdate:date":a[2]||(a[2]=h=>o(e).startAt.$model=h)},null,8,["error-messages","date"])]),_:1}),l(X,{class:"pa-0"},{default:i(()=>[l(_,{"error-messages":o(e).endAt.$errors.length>0?o(e).endAt.$errors[0].$message:"",date:o(e).endAt.$model,"onUpdate:date":a[3]||(a[3]=h=>o(e).endAt.$model=h)},null,8,["error-messages","date"])]),_:1})]),l(T,{modelValue:o(e).location.$model,"onUpdate:modelValue":a[4]||(a[4]=h=>o(e).location.$model=h),flat:"",label:"Location","single-line":"",variant:"solo-filled",density:"compact","prepend-inner-icon":"mdi-map-marker"},null,8,["modelValue"]),l(T,{"error-messages":((J=o(e).link.$errors[0])==null?void 0:J.$message.toString())||"",modelValue:o(e).link.$model,"onUpdate:modelValue":a[5]||(a[5]=h=>o(e).link.$model=h),flat:"",label:"Video meeting link","single-line":"",variant:"solo-filled",density:"compact","prepend-inner-icon":"mdi-link-variant"},null,8,["error-messages","modelValue"]),l(z,{tags:o(e).tags.$model,"onUpdate:tags":a[6]||(a[6]=h=>o(e).tags.$model=h)},null,8,["tags"]),A("div",Se,[l(D,{"prepend-icon":"mdi-pencil-outline",type:"submit",flat:"",loading:o(V),class:"w-50 text-capitalize",color:"primary"},{default:i(()=>[k("Edit")]),_:1},8,["loading"]),l(D,{"prepend-icon":"mdi-cancel",onClick:a[7]||(a[7]=h=>d("close")),flat:"",class:"w-50 text-capitalize border"},{default:i(()=>[k("Cancel ")]),_:1})])]}),_:1})}}});export{Pe as _,_e as a,be as b,Ve as u};
